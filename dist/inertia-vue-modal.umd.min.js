(function(e,r){"object"===typeof exports&&"object"===typeof module?module.exports=r(require("@inertiajs/inertia"),require("@inertiajs/inertia-vue3"),require("axios"),require("vue")):"function"===typeof define&&define.amd?define(["@inertiajs/inertia","@inertiajs/inertia-vue3","axios"],r):"object"===typeof exports?exports["inertia-vue-modal"]=r(require("@inertiajs/inertia"),require("@inertiajs/inertia-vue3"),require("axios"),require("vue")):e["inertia-vue-modal"]=r(e["@inertiajs/inertia"],e["@inertiajs/inertia-vue3"],e["axios"],e["Vue"])})("undefined"!==typeof self?self:this,((e,r,t,n)=>(()=>{var o={679:function(e,r){var t,n,o;(function(a,i){n=[],t=i,o="function"===typeof t?t.apply(r,n):t,void 0===o||(e.exports=o)})("undefined"!==typeof self&&self,(function(){function e(){var r=Object.getOwnPropertyDescriptor(document,"currentScript");if(!r&&"currentScript"in document&&document.currentScript)return document.currentScript;if(r&&r.get!==e&&document.currentScript)return document.currentScript;try{throw new Error}catch(v){var t,n,o,a=/.*at [^(]*\((.*):(.+):(.+)\)$/gi,i=/@([^@]*):(\d+):(\d+)\s*$/gi,u=a.exec(v.stack)||i.exec(v.stack),c=u&&u[1]||!1,l=u&&u[2]||!1,s=document.location.href.replace(document.location.hash,""),p=document.getElementsByTagName("script");c===s&&(t=document.documentElement.outerHTML,n=new RegExp("(?:[^\\n]+?\\n){0,"+(l-2)+"}[^<]*<script>([\\d\\D]*?)<\\/script>[\\d\\D]*","i"),o=t.replace(n,"$1").trim());for(var d=0;d<p.length;d++){if("interactive"===p[d].readyState)return p[d];if(p[d].src===c)return p[d];if(c===s&&p[d].innerHTML&&p[d].innerHTML.trim()===o)return p[d]}return null}}return e}))},263:e=>{"use strict";function r(e){this.message=e}r.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},r.prototype.__CANCEL__=!0,e.exports=r},767:r=>{"use strict";r.exports=e},365:e=>{"use strict";e.exports=r},300:e=>{"use strict";e.exports=t},203:e=>{"use strict";e.exports=n}},a={};function i(e){var r=a[e];if(void 0!==r)return r.exports;var t=a[e]={exports:{}};return o[e].call(t.exports,t,t.exports,i),t.exports}(()=>{i.n=e=>{var r=e&&e.__esModule?()=>e["default"]:()=>e;return i.d(r,{a:r}),r}})(),(()=>{i.d=(e,r)=>{for(var t in r)i.o(r,t)&&!i.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:r[t]})}})(),(()=>{i.o=(e,r)=>Object.prototype.hasOwnProperty.call(e,r)})(),(()=>{i.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}})(),(()=>{i.p=""})();var u={};return(()=>{"use strict";if(i.r(u),i.d(u,{InertiaModal:()=>w,ModalSlot:()=>I,ModalableWrapper:()=>q,usePage:()=>$}),"undefined"!==typeof window){var e=window.document.currentScript,r=i(679);e=r(),"currentScript"in document||Object.defineProperty(document,"currentScript",{get:r});var t=e&&e.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);t&&(i.p=t[1])}var n=function(){return n=Object.assign||function(e){for(var r,t=1,n=arguments.length;t<n;t++)for(var o in r=arguments[t],r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o]);return e},n.apply(this,arguments)};Object.create;Object.create;var o=i(203),a=i(767),c=i(300),l=i.n(c),s=i(263),p=i.n(s);function d(e,r){return document.dispatchEvent(new CustomEvent("inertia:".concat(e),r))}var v=function(e){return d("error",{detail:{errors:e}})},f=function(e){return d("success",{detail:{page:e}})},m=1;const g=function(){return"id-".concat(m++)};var y="InertiaIsModal",h="ModalSlotRef",S="X-Inertia-Modal",k=function(){var e=(0,o.shallowRef)(null),r=function(r){e.value=r};return(0,o.provide)(h,r),e},j=function(){return(0,o.inject)(h)},B={name:"InertiaModal"};const b=(0,o.defineComponent)(n(n({},B),{props:{component:String,componentAttrs:Object,modalKey:{type:String,default:""}},setup:function(e){var r=e,t=(0,o.shallowRef)(null),i=k();(0,o.provide)(y,t);var u=function(){t.value&&(t.value.loading||(t.value.removeBeforeEventListener(),t.value.removeSuccessEventListener&&t.value.removeSuccessEventListener(),l().interceptors.response.eject(t.value.interceptor)),t.value.cancelToken.value&&t.value.cancelToken.value.cancel("Modal closed"),"onClose"in t.value&&t.value.onClose&&t.value.onClose(t.value)),document.dispatchEvent(new CustomEvent("inertia:modal-closed",{detail:t.value})),t.value=null},c=function(e,r){var i;void 0===r&&(r={});var c,s=n({headers:{},redirectBack:!0,modalProps:{},pageProps:{}},r),d=(0,o.shallowRef)(null),m=function(e){return new URL(e.toString(),window.location.toString())},y=g(),h=null,k=l().interceptors.response.use((function(e){if(e.headers[S.toLowerCase()]===y){var r=e.data;r.url=m(r.url),(null===h||void 0===h?void 0:h.only)&&c&&c.component===r.component&&(r.props=n(n({},c.props),r.props));var o=h?a.Inertia.activeVisit:s,i=o.onError,g=o.onSuccess,j=o.errorBag;return Promise.resolve(a.Inertia.resolveComponent(r.component)).then((function(e){var t=r.props.errors||{};if(Object.keys(t).length>0){var n=j?t[j]||{}:t;v(n),i&&i(n)}else f(r),g&&g(r);return e})).then((function(e){var n;a.Inertia.finishVisit(a.Inertia.activeVisit),t.value&&"removeBeforeEventListener"in t.value&&t.value.removeBeforeEventListener();var o=a.Inertia.on("before",(function(e){if(e.detail.visit.url.pathname===r.url.pathname){e.detail.visit.headers[S]=y,h=e.detail.visit,c=r;var t=l().interceptors.request.use((function(e){return e.headers[S]===y&&(l().interceptors.request.eject(t),e.headers["X-Inertia-Partial-Component"]=r.component),e}))}else s.redirectBack&&(e.detail.visit.headers["X-Inertia-Modal-Redirect-Back"]="true","function"===typeof s.redirectBack&&(n=a.Inertia.on("success",s.redirectBack)))}));t.value={loading:!1,component:e,removeBeforeEventListener:o,removeSuccessEventListener:n,interceptor:k,page:r,cancelToken:d,onClose:s.onClose,props:s.modalProps,pageProps:s.pageProps,close:u}})),Promise.reject(new(p()))}return e}));a.Inertia.visit(e,n(n({},s),{onCancelToken:function(e){d.value=e},headers:n(n({},s.headers),(i={},i[S]=y,i))})),t.value={loading:!0,cancelToken:d,close:u}};return(0,o.watch)((function(){return r.modalKey}),(function(e){var r="visitInModal".concat(e);a.Inertia[r]=c}),{immediate:!0}),function(e,r){return(0,o.unref)(t)?((0,o.openBlock)(),(0,o.createElementBlock)(o.Fragment,{key:0},[(0,o.renderSlot)(e.$slots,"default",{loading:(0,o.unref)(t).loading,component:(0,o.unref)(t).component,page:(0,o.unref)(t).page,close:(0,o.unref)(t).close,props:(0,o.unref)(t).props}),(0,o.unref)(t).component&&(0,o.unref)(i)?((0,o.openBlock)(),(0,o.createBlock)(o.Teleport,{key:0,to:(0,o.unref)(i)},[((0,o.openBlock)(),(0,o.createBlock)((0,o.resolveDynamicComponent)((0,o.unref)(t).component),(0,o.mergeProps)({"is-modal":""},n(n({},(0,o.unref)(t).page.props),(0,o.unref)(t).pageProps)),null,16))],8,["to"])):(0,o.createCommentVNode)("",!0)],64)):(0,o.createCommentVNode)("",!0)}}})),x=b,w=x,C=function(){return(0,o.inject)(y,!1)};var E={name:"ModalSlot"};const M=(0,o.defineComponent)(n(n({},E),{setup:function(e){var r=j();return function(e,t){return(0,o.openBlock)(),(0,o.createElementBlock)("div",{ref:(0,o.unref)(r)},null,512)}}})),P=M,I=P;var O={name:"ModalableWrapper"};const L=(0,o.defineComponent)(n(n({},O),{setup:function(e){var r=k(),t=C();return function(e,n){return(0,o.openBlock)(),(0,o.createElementBlock)(o.Fragment,null,[(0,o.unref)(t)?(0,o.renderSlot)(e.$slots,"modal-only",{key:1,close:(0,o.unref)(t).close},(function(){return[(0,o.createVNode)(I)]})):(0,o.renderSlot)(e.$slots,"default",{key:0},(function(){return[(0,o.createVNode)(I)]})),(0,o.unref)(r)?((0,o.openBlock)(),(0,o.createBlock)(o.Teleport,{key:2,to:(0,o.unref)(r)},[(0,o.renderSlot)(e.$slots,"modal",{close:(0,o.unref)(t).close})],8,["to"])):(0,o.createCommentVNode)("",!0)],64)}}})),T=L,q=T;var V=i(365);const $=function(){var e=C(),r=(0,V.usePage)();return e&&e.value?{isModal:!0,parent:r,props:(0,o.computed)((function(){return e.value&&!e.value.loading?e.value.page.props:{}})),url:(0,o.computed)((function(){return e.value&&!e.value.loading&&e.value.page.url})),component:(0,o.computed)((function(){return e.value&&!e.value.loading&&e.value.page.component})),version:(0,o.computed)((function(){return e.value&&!e.value.loading&&e.value.page.version}))}:r}})(),u})()));
//# sourceMappingURL=inertia-vue-modal.umd.min.js.map